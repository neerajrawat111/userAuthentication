{
  "stats": {
    "suites": 2,
    "tests": 8,
    "passes": 8,
    "pending": 0,
    "failures": 0,
    "start": "2024-11-21T07:57:28.781Z",
    "end": "2024-11-21T07:57:29.296Z",
    "duration": 515,
    "testsRegistered": 8,
    "passPercent": 100,
    "pendingPercent": 0,
    "other": 0,
    "hasOther": false,
    "skipped": 0,
    "hasSkipped": false
  },
  "results": [
    {
      "uuid": "23f251a7-76f7-4488-a8a1-a514a47031ec",
      "title": "",
      "fullFile": "",
      "file": "",
      "beforeHooks": [],
      "afterHooks": [],
      "tests": [],
      "suites": [
        {
          "uuid": "64535882-6e90-4541-8896-5198ac97b016",
          "title": "SignUp Tests",
          "fullFile": "/Users/newtonschool/Downloads/Auth/Authentication 2/__tests__/test.js",
          "file": "/__tests__/test.js",
          "beforeHooks": [
            {
              "title": "\"before each\" hook in \"SignUp Tests\"",
              "fullTitle": "SignUp Tests \"before each\" hook in \"SignUp Tests\"",
              "timedOut": false,
              "duration": 0,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "await prisma.user.deleteMany();",
              "err": {},
              "uuid": "d8d72180-3577-4c3b-9f42-f4d47a114ca4",
              "parentUUID": "64535882-6e90-4541-8896-5198ac97b016",
              "isHook": true,
              "skipped": false
            }
          ],
          "afterHooks": [],
          "tests": [
            {
              "title": "should create account for a given user",
              "fullTitle": "SignUp Tests should create account for a given user",
              "timedOut": false,
              "duration": 154,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const newUser = {\n  name: 'logan',\n  email: 'logan12@gmail.com',\n  password: 'logan1234',\n};\n// Send request to create a new user\nconst res = await chai.request(app).post('/api/auth/signup').send(newUser);\nexpect(res).to.have.status(201);\nexpect(res.body).to.be.an('object');\nexpect(res.body).to.have.property('userId');\n// Verify user in the database\nconst userInDb = await prisma.user.findUnique({\n  where: { id: res.body.userId },\n});\nexpect(userInDb).to.exist;\nexpect(userInDb.email).to.equal(newUser.email);\n// Check if password is hashed correctly\nconst isPasswordValid = await bcrypt.compare(newUser.password, userInDb.password);\nexpect(isPasswordValid).to.be.true;",
              "err": {},
              "uuid": "51464003-bf1f-4eb0-ac99-838615a87785",
              "parentUUID": "64535882-6e90-4541-8896-5198ac97b016",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "should return 400 if email is missing",
              "fullTitle": "SignUp Tests should return 400 if email is missing",
              "timedOut": false,
              "duration": 2,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const userWithoutEmail = {\n  name: 'logan',\n  password: 'password123',\n};\n  \nconst res = await chai.request(app).post('/api/auth/signup').send(userWithoutEmail);\nexpect(res).to.have.status(400);\nexpect(res.body).to.be.an('object');\nexpect(res.body).to.have.property('error');",
              "err": {},
              "uuid": "adb02b29-4be3-4dd2-a033-adcf40c38743",
              "parentUUID": "64535882-6e90-4541-8896-5198ac97b016",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "should return 400 if password is missing",
              "fullTitle": "SignUp Tests should return 400 if password is missing",
              "timedOut": false,
              "duration": 3,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const userWithoutPassword = {\n  name: 'logan',\n  email: 'logan@gmail.com',\n};\n  \nconst res = await chai.request(app).post('/api/auth/signup').send(userWithoutPassword);\nexpect(res).to.have.status(400);\nexpect(res.body).to.be.an('object');\nexpect(res.body).to.have.property('error');",
              "err": {},
              "uuid": "36d6f672-9857-4236-a2a6-3ebe82279aec",
              "parentUUID": "64535882-6e90-4541-8896-5198ac97b016",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "should return 400 if the email is already in use",
              "fullTitle": "SignUp Tests should return 400 if the email is already in use",
              "timedOut": false,
              "duration": 63,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const existingUser = {\n  name: 'logan',\n  email: 'logan@gmail.com',\n  password: await bcrypt.hash('logan123', 10),\n};\nawait prisma.user.create({ data: existingUser });\nconst duplicateUser = {\n  name: 'logan',\n  email: 'logan@gmail.com', \n  password: 'logan123',\n};\nconst res = await chai.request(app).post('/api/auth/signup').send(duplicateUser);\nexpect(res).to.have.status(400);\nexpect(res.body).to.be.an('object');\nexpect(res.body).to.have.property('error', 'Email already in use');",
              "err": {},
              "uuid": "529aed98-d8b9-4561-8fb1-59b6172cdb24",
              "parentUUID": "64535882-6e90-4541-8896-5198ac97b016",
              "isHook": false,
              "skipped": false
            }
          ],
          "suites": [],
          "passes": [
            "51464003-bf1f-4eb0-ac99-838615a87785",
            "adb02b29-4be3-4dd2-a033-adcf40c38743",
            "36d6f672-9857-4236-a2a6-3ebe82279aec",
            "529aed98-d8b9-4561-8fb1-59b6172cdb24"
          ],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 222,
          "root": false,
          "rootEmpty": false,
          "_timeout": 60000
        },
        {
          "uuid": "896dc156-3802-40d0-8824-dcc3d031146b",
          "title": "Login Tests",
          "fullFile": "/Users/newtonschool/Downloads/Auth/Authentication 2/__tests__/test.js",
          "file": "/__tests__/test.js",
          "beforeHooks": [
            {
              "title": "\"before each\" hook in \"Login Tests\"",
              "fullTitle": "Login Tests \"before each\" hook in \"Login Tests\"",
              "timedOut": false,
              "duration": 1,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "await prisma.user.deleteMany();",
              "err": {},
              "uuid": "df24ddfa-7dd0-483e-a032-06399c5dfb76",
              "parentUUID": "896dc156-3802-40d0-8824-dcc3d031146b",
              "isHook": true,
              "skipped": false
            }
          ],
          "afterHooks": [],
          "tests": [
            {
              "title": "should log in successfully with valid credentials",
              "fullTitle": "Login Tests should log in successfully with valid credentials",
              "timedOut": false,
              "duration": 61,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const existingUser = {\n      name: 'logan',\n      email: 'logan@gmail.com',\n      password: await bcrypt.hash('logan123', 10),\n    };\n    const createdUser= await prisma.user.create({ data: existingUser });\n    \n    const data = {\n      email: \"logan@gmail.com\",\n      password: \"logan123\"\n    };\n    \n    chai\n      .request(app)\n      .post('/api/auth/login')\n      .send(data)\n      .end((err, res) => {\n        expect(res).to.have.status(200);\n        expect(res.body).to.be.an('object');\n        expect(res.body).to.have.property('userdata');\n        expect(res.body.userdata).to.have.property('id');\n        expect(res.body.userdata).to.have.property('name');\n        expect(res.body.userdata).to.have.property('email');\n        expect(res.body).to.have.property('accesstoken');\n        const token = res.body.accesstoken;\n        try {\n          const decoded = jwt.verify(token, JWT_SECRET);\n          expect(decoded).to.be.an('object');\n          expect(decoded).to.have.property('userId', createdUser.id);\n        } catch (error) {\n          throw new Error(`Token verification failed: ${error.message}`);\n        }\n      });",
              "err": {},
              "uuid": "23019a5d-9bb9-4981-9c51-0d1ed5490daf",
              "parentUUID": "896dc156-3802-40d0-8824-dcc3d031146b",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "should return 400 if email or password is missing",
              "fullTitle": "Login Tests should return 400 if email or password is missing",
              "timedOut": false,
              "duration": 1,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "chai\n  .request(app)\n  .post('/api/auth/login')\n  .send({ email: \"logan@gmail.com\" }) // Password is missing\n  .end((err, res) => {\n    expect(res).to.have.status(400);\n    expect(res.body).to.be.an('object');\n    expect(res.body).to.have.property('error', 'Email and password are required');\n  });",
              "err": {},
              "uuid": "5dd7ec23-7347-4d0d-a4c6-0339c6e680a6",
              "parentUUID": "896dc156-3802-40d0-8824-dcc3d031146b",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "should return 401 if the password is incorrect",
              "fullTitle": "Login Tests should return 401 if the password is incorrect",
              "timedOut": false,
              "duration": 118,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const existingUser = {\n  name: 'logan',\n  email: 'logan@gmail.com',\n  password: await bcrypt.hash('correctpassword', 10),\n};\nawait prisma.user.create({ data: existingUser });\n  \nconst invalidCredentials = {\n  email: 'logan@gmail.com',\n  password: 'wrongpassword', // Incorrect password\n};\n  \nconst res = await chai.request(app).post('/api/auth/login').send(invalidCredentials);\nexpect(res).to.have.status(401);\nexpect(res.body).to.be.an('object');\nexpect(res.body).to.have.property('error', 'Invalid credentials');",
              "err": {},
              "uuid": "276abea5-0c7b-456e-bb2a-fd976d3b55d0",
              "parentUUID": "896dc156-3802-40d0-8824-dcc3d031146b",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "should return 404 if the user is not found",
              "fullTitle": "Login Tests should return 404 if the user is not found",
              "timedOut": false,
              "duration": 1,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "// Data for a non-existing user\nconst nonExistingUser = {\n  email: 'nonexistentuser@gmail.com',\n  password: 'somepassword',\n};\nchai\n  .request(app)\n  .post('/api/auth/login')\n  .send(nonExistingUser)\n  .end((err, res) => {\n    // Assert that the response status is 404 (User Not Found)\n    expect(res).to.have.status(404);\n    expect(res.body).to.be.an('object');\n    expect(res.body).to.have.property('error', 'User not found');\n  });",
              "err": {},
              "uuid": "ed7e0fb9-c645-475b-98a3-476e2f6b1aec",
              "parentUUID": "896dc156-3802-40d0-8824-dcc3d031146b",
              "isHook": false,
              "skipped": false
            }
          ],
          "suites": [],
          "passes": [
            "23019a5d-9bb9-4981-9c51-0d1ed5490daf",
            "5dd7ec23-7347-4d0d-a4c6-0339c6e680a6",
            "276abea5-0c7b-456e-bb2a-fd976d3b55d0",
            "ed7e0fb9-c645-475b-98a3-476e2f6b1aec"
          ],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 181,
          "root": false,
          "rootEmpty": false,
          "_timeout": 60000
        }
      ],
      "passes": [],
      "failures": [],
      "pending": [],
      "skipped": [],
      "duration": 0,
      "root": true,
      "rootEmpty": true,
      "_timeout": 60000
    }
  ],
  "meta": {
    "mocha": {
      "version": "8.4.0"
    },
    "mochawesome": {
      "options": {
        "quiet": false,
        "reportFilename": "mochawesome",
        "saveHtml": true,
        "saveJson": true,
        "consoleReporter": "spec",
        "useInlineDiffs": false,
        "code": true
      },
      "version": "6.3.1"
    },
    "marge": {
      "options": null,
      "version": "5.2.0"
    }
  }
}